<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Doc | a little bit of money</title>
  <link rel="icon" type="image/svg+xml" href="/assets/favicon.svg" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="/assets/styles.css" />
</head>
<body data-page="doc">
  <header class="top-nav">
    <a class="brand" href="/" data-nav-transition>
      <span class="brand-core">A LITTLE BIT OF</span>
      <span class="brand-accent">MONEY</span>
    </a>
    <nav class="nav-links" aria-label="Main Navigation">
      <a class="nav-link" href="/" data-nav-transition>Home</a>
      <a class="nav-link" href="/catalog" data-nav-transition>Catalog</a>
      <a class="nav-link active" href="/doc" data-nav-transition>API Doc</a>
    </nav>
  </header>

  <main class="page">
    <section class="hero reveal" style="min-height: 48vh;">
      <div class="hero-content">
        <p class="eyebrow">Developer Guide</p>
        <h1 class="glow-title">Lightning Payment Flow</h1>
        <p class="hero-sub">Send request, pay the invoice with your wallet, redeem using preimage.</p>
      </div>
    </section>

    <section class="section reveal">
      <h2>Endpoints</h2>
      <div class="docs-grid">
        <article class="glass-card">
          <h3>Core Routes</h3>
          <ul>
            <li><span class="inline-code">POST /{api_name}/{endpoint}</span> returns <span class="inline-code">402</span> with invoice and payment hash.</li>
            <li><span class="inline-code">GET /redeem?preimage=...</span> verifies payment proof and returns response body.</li>
            <li><span class="inline-code">GET /api/catalog</span> lists configured APIs and sat pricing.</li>
          </ul>
        </article>
        <article class="glass-card">
          <h3>Use Any Wallet</h3>
          <ul>
            <li>Pay the BOLT11 invoice with your wallet.</li>
            <li>Get the payment preimage from your wallet or node payment details.</li>
            <li>Call <span class="inline-code">/redeem?preimage=...</span> once to fetch the upstream result.</li>
          </ul>
        </article>
      </div>
    </section>

    <section class="section reveal">
      <h2>Basic Payment Flow</h2>
      <p class="section-intro">This is the minimal integration pattern for clients. API-specific examples are in <a href="/catalog" data-nav-transition>Catalog</a>.</p>
      <div class="grid cols-3">
        <article class="code-card">
          <div class="code-head"><span>bash</span><button class="copy-btn" data-copy-target="#flow-bash">Copy</button></div>
          <pre><code id="flow-bash">API="https://alittlebitofmoney.com"
ENDPOINT="/openai/v1/chat/completions"

STEP1=$(curl -s -X POST "$API$ENDPOINT" \
  -H "Content-Type: application/json" \
  -d '{"model":"gpt-4o-mini","messages":[{"role":"user","content":"Say hello"}]}' )

INVOICE=$(echo "$STEP1" | jq -r '.invoice')
echo "Pay this invoice with your wallet:"
echo "$INVOICE"

read -r -p "Preimage: " PREIMAGE
curl -s "$API/redeem?preimage=$PREIMAGE" | jq .</code></pre>
        </article>

        <article class="code-card">
          <div class="code-head"><span>python</span><button class="copy-btn" data-copy-target="#flow-python">Copy</button></div>
          <pre><code id="flow-python">import requests

API = "https://alittlebitofmoney.com"
endpoint = "/openai/v1/chat/completions"

step1 = requests.post(f"{API}{endpoint}", json={
    "model": "gpt-4o-mini",
    "messages": [{"role": "user", "content": "Say hello"}],
})

invoice = step1.json()["invoice"]
print("Pay this invoice with your wallet:")
print(invoice)

preimage = input("Preimage: ").strip()
result = requests.get(f"{API}/redeem", params={"preimage": preimage})
print(result.json())</code></pre>
        </article>

        <article class="code-card">
          <div class="code-head"><span>javascript</span><button class="copy-btn" data-copy-target="#flow-js">Copy</button></div>
          <pre><code id="flow-js">const API = "https://alittlebitofmoney.com";
const endpoint = "/openai/v1/chat/completions";

const step1 = await fetch(`${API}${endpoint}`, {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    model: "gpt-4o-mini",
    messages: [{ role: "user", content: "Say hello" }],
  }),
});

const { invoice } = await step1.json();
console.log("Pay this invoice with your wallet:", invoice);

const preimage = prompt("Preimage:");
const result = await fetch(`${API}/redeem?preimage=${preimage}`);
console.log(await result.json());</code></pre>
        </article>
      </div>
    </section>

    <section class="section reveal">
      <h2>Wallet Integrations</h2>
      <p class="section-intro">Any Lightning wallet works if it can return payment preimage after a successful invoice payment.</p>
      <div class="grid cols-3">
        <article class="glass-card">
          <h3>LND</h3>
          <p>Best for backend services. Pay invoice using LND and read preimage from payment response or invoice lookup.</p>
        </article>
        <article class="glass-card">
          <h3>Core Lightning</h3>
          <p>Use CLN for programmatic payments and extract preimage from <span class="inline-code">listpays</span> response.</p>
        </article>
        <article class="glass-card">
          <h3>Phoenixd</h3>
          <p>Server-side integration path with direct payment APIs and preimage access in payment metadata.</p>
        </article>
        <article class="glass-card">
          <h3>Alby Hub</h3>
          <p>Good for browser/server apps that need wallet API access and payment details for redeem.</p>
        </article>
        <article class="glass-card">
          <h3>LNbits</h3>
          <p>Simple hosted/self-hosted API wallet route for handling invoice payment and reading preimage data.</p>
        </article>
        <article class="glass-card">
          <h3>Zeus + Node</h3>
          <p>Use Zeus connected to your own LND/CLN node for mobile control while keeping preimage access.</p>
        </article>
      </div>
      <div class="status-note" style="margin-top: 1rem;">If a wallet UI does not show preimage directly, pay from a node-connected wallet/API and fetch the preimage from payment records.</div>
    </section>

    <section class="section reveal" id="api-policy">
      <h2>Policy</h2>
      <div class="glass-card">
        <p>Access is pay-per-request. Pricing and endpoint availability may change. Abusive usage may be blocked.</p>
      </div>
    </section>

    <section class="section reveal" id="terms">
      <h2>Terms</h2>
      <div class="glass-card">
        <p>This service is provided as-is. You are responsible for your wallet credentials, invoices, and upstream API usage.</p>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="footer-links">
      <a href="mailto:hello@alittlebitofmoney.com">Contact Us</a>
      <a href="/doc#api-policy" data-nav-transition>Policy</a>
      <a href="/doc#terms" data-nav-transition>Terms</a>
    </div>
    <div>Version <span data-version>v0.2.0</span> | <span data-year></span> | alittlebitofmoney.com</div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>
  <script src="/assets/app.js?v=20260223b"></script>
</body>
</html>
